--Tempo nouvelle chaîne
SELECT COUNT(1)
FROM SGEL_PRM_SCH.T_SITUATION_CONTRACTUELLE situ
JOIN SGEL_SCH.T_CALENDRIER cal ON cal.CAL_CODE = situ.SCN_GF_CALENDRIER_FOURN_CODE
WHERE 1=1
AND situ.SCN_APP_APPLICATION_CODE IN ('GINKO')
AND situ.SCN_SITU_TYPE = 'C'
--AND situ.SCN_SIT_ETAT_CODE = 'actif' !champ de mauvaise qualité!
AND situ.SCN_SIT_DATE_FIN IS NULL
AND cal.
GROUP BY cal.CAL_CODE_COPIE
;
41308

--Tempo ancienne chaîne
SELECT COUNT(1)
FROM SGEL_PRM_SCH.T_SITUATION_CONTRACTUELLE situ
JOIN SGEL_SCH.T_CALENDRIER cal ON cal.CAL_CODE = situ.SCN_GF_CALENDRIER_FOURN_CODE
WHERE 1=1
AND situ.SCN_APP_APPLICATION_CODE IN ('QETGC')
AND situ.SCN_SITU_TYPE = 'C'
--AND situ.SCN_SIT_ETAT_CODE = 'actif' !champ de mauvaise qualité!
AND situ.SCN_SIT_DATE_FIN IS NULL
AND situ.SCN_ST_CODE_TARIF_ACH_DISCO IN
('5203',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5203',
'5304',
'5305',
'5306',
'5407',
'5408',
'5409',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5203',
'5304',
'5305',
'5306',
'5408',
'5409',
'5703',
'5804',
'5805',
'5806',
'5908',
'5909',
'6402',
'6403',
'6504',
'6505',
'6506',
'6607',
'6608',
'6609')
;
137021

--EJP ancienne chaîne
SELECT COUNT(1), SUBSTR(prm.PRM_AI_CODE_POSTAL, 1, 2) as DEPARTEMENT
FROM SGEL_PRM_SCH.T_PRM prm
JOIN SGEL_PRM_SCH.T_SITUATION_CONTRACTUELLE situ ON prm.SCN_ID = situ.SCN_ID
WHERE 1=1
AND situ.SCN_APP_APPLICATION_CODE IN ('QETGC')
AND situ.SCN_SITU_TYPE = 'C'
--AND situ.SCN_SIT_ETAT_CODE = 'actif' !champ de mauvaise qualité!
AND situ.SCN_SIT_DATE_FIN IS NULL
AND situ.SCN_ST_CODE_TARIF_ACH_DISCO IN
('5123',
'5144',
'5145',
'5146',
'5169',
'5144',
'5145',
'5146',
'5146',
'5169',
'5169',
'5169',
'5123',
'5144',
'5145',
'5146',
'5169',
'5144',
'5146',
'5144',
'5146',
'5169',
'5169',
'5144',
'5146',
'5169',
'5144',
'5145',
'5146',
'5169')
GROUP BY SUBSTR(prm.PRM_AI_CODE_POSTAL, 1, 2)
ORDER BY 2
;
448329

--EJP nouvelle chaîne
SELECT COUNT(1), situ.SCN_ST_GRP_PERIODE_MOBILE_CODE as GPM
FROM SGEL_PRM_SCH.T_SITUATION_CONTRACTUELLE situ
WHERE 1=1
AND situ.SCN_APP_APPLICATION_CODE IN ('GINKO')
AND situ.SCN_GF_CALENDRIER_FOURN_CODE = 'FC000049'
AND situ.SCN_SITU_TYPE = 'C'
AND situ.SCN_SIT_DATE_FIN IS NULL
GROUP BY situ.SCN_ST_GRP_PERIODE_MOBILE_CODE
ORDER BY 2
;